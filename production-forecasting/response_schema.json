{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Forecast Response",
  "description": "Response schema for POST /forecast endpoint",
  "oneOf": [
    {
      "title": "Success Response",
      "type": "object",
      "required": ["predictions"],
      "properties": {
        "predictions": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "number"
              },
              "description": "Array of forecasted values when no timestamps available: [value1, value2, ...]"
            },
            {
              "type": "array",
              "items": {
                "type": "array",
                "minItems": 2,
                "maxItems": 2,
                "items": [
                  {
                    "oneOf": [
                      {
                        "type": "integer",
                        "description": "Unix timestamp (seconds)"
                      },
                      {
                        "type": "string",
                        "format": "date-time",
                        "description": "ISO 8601 timestamp string"
                      }
                    ]
                  },
                  {
                    "type": "number",
                    "description": "Forecasted value"
                  }
                ]
              },
              "description": "Array of [timestamp, value] pairs when timestamps available"
            }
          ]
        },
        "granularity": {
          "type": "integer",
          "description": "Detected time granularity in seconds (only present if evaluation=false and timestamps available)."
        },
        "metrics": {
          "type": "object",
          "required": ["mape", "rmse", "mbe"],
          "properties": {
            "mape": {
              "type": "number",
              "description": "Symmetric Mean Absolute Percentage Error (%)"
            },
            "rmse": {
              "type": "number",
              "description": "Root Mean Squared Error"
            },
            "mbe": {
              "type": "number",
              "description": "Mean Bias Error"
            }
          },
          "description": "Evaluation metrics (only present if evaluation=true)"
        },
        "actuals": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "number"
              },
              "description": "Array of actual values when no timestamps available"
            },
            {
              "type": "array",
              "items": {
                "type": "array",
                "minItems": 2,
                "maxItems": 2,
                "items": [
                  {
                    "oneOf": [
                      {
                        "type": "integer",
                        "description": "Unix timestamp (seconds)"
                      },
                      {
                        "type": "string",
                        "format": "date-time",
                        "description": "ISO 8601 timestamp string"
                      }
                    ]
                  },
                  {
                    "type": "number",
                    "description": "Actual value"
                  }
                ]
              },
              "description": "Array of [timestamp, value] pairs for actual values"
            }
          ],
          "description": "Actual values for the last 'horizon' points (only present if evaluation=true)"
        },
        "visualization_url": {
          "type": "string",
          "format": "uri",
          "description": "URL to access Chart.js visualization HTML (only present if invoke_helper=true)"
        }
      }
    },
    {
      "title": "Error Response",
      "type": "object",
      "required": ["error"],
      "properties": {
        "error": {
          "type": "string",
          "description": "Error message describing what went wrong"
        }
      }
    }
  ],
  "examples": [
    {
      "predictions": [
        ["2025-01-01T01:00:00", 51.234],
        ["2025-01-01T02:00:00", 52.456],
        ["2025-01-01T03:00:00", 53.678],
        ["2025-01-01T04:00:00", 54.89],
        ["2025-01-01T05:00:00", 56.012]
      ],
      "metrics": {
        "mape": 2.34,
        "rmse": 1.23,
        "mbe": 0.45
      },
      "actuals": [
        ["2025-01-01T01:00:00", 51.0],
        ["2025-01-01T02:00:00", 52.0],
        ["2025-01-01T03:00:00", 53.0],
        ["2025-01-01T04:00:00", 54.0],
        ["2025-01-01T05:00:00", 55.0]
      ]
    },
    {
      "predictions": [
        [1765387008, 0.0251234],
        [1765120896, 0.0252456],
        [1764854784, 0.0253678],
        [1764588672, 0.025489],
        [1764322560, 0.0256012]
      ],
      "metrics": {
        "mape": 1.23,
        "rmse": 0.0012,
        "mbe": 0.0001
      },
      "actuals": [
        [1765387008, 0.0251],
        [1765120896, 0.0252],
        [1764854784, 0.0253],
        [1764588672, 0.0254],
        [1764322560, 0.0255]
      ],
      "visualization_url": "https://localhost:5000/visualization.html"
    },
    {
      "predictions": [
        ["2025-01-02T10:00:00", 51.234],
        ["2025-01-02T11:00:00", 52.456],
        ["2025-01-02T12:00:00", 53.678],
        ["2025-01-02T13:00:00", 54.89],
        ["2025-01-02T14:00:00", 56.012],
        ["2025-01-02T15:00:00", 57.134],
        ["2025-01-02T16:00:00", 58.256],
        ["2025-01-02T17:00:00", 59.378],
        ["2025-01-02T18:00:00", 60.49],
        ["2025-01-02T19:00:00", 61.612]
      ],
      "granularity": 3600
    },
    {
      "predictions": [51.234, 52.456, 53.678, 54.89, 56.012, 57.134, 58.256, 59.378, 60.49, 61.612]
    },
    {
      "error": "Invalid horizon: must be positive integer"
    },
    {
      "error": "Insufficient data for forecasting"
    }
  ]
}
